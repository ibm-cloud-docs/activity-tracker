---

copyright:
  years: 2019, 2022
lastupdated: "2022-06-22"

keywords: 

subcollection: activity-tracker

---

{{site.data.keyword.attribute-definition-list}}
 

# Using the Track Archiving template
{: #templates-archiving}

Use the {{site.data.keyword.at_full_notm}} archiving template (Track Archiving) to monitor {{site.data.keyword.at_short}} instances and {{site.data.keyword.la_short}} instances that have the archiving feature enabled and configured to send data to an IBM Cloud Object Storage bucket.
{: shortdesc}

## Overview
{: #templates-archiving-ov}

The {{site.data.keyword.at_short}} archiving template includes the following artifacts:
- Parsing templates to pull additional information from the data to enhance searchability and simplify customization such as `bucketName`, `region`, `RC` and `accountID`.
- Views, dashboards, and screens that allow you to monitor the Cloud Object Storage buckets where data from an {{site.data.keyword.at_short}} instances and {{site.data.keyword.la_short}} instances are archived.
- Alert definitions that you must configure and expand by adding notification channels to be notified as soon as a critical condition happens such as a request from an unauthorized requester.

This template uses auditing events from the following services:

- Cloud Object Storage: 

    This template uses Cloud Object Storage data auditing events to monitor when objects are uploaded to a bucket and management events to monitor the deletion of buckets. 

    Cloud Object Storage management events are global, which means that the events are available through the Franfurt {{site.data.keyword.at_short}} instance if you have configured your account to manage auditing events by using the {{site.data.keyword.at_short}} hosted event search offering. However, if you configure your account to manage auditing events by using {{site.data.keyword.atracker_short}}, you can choose the {{site.data.keyword.at_short}} instance where you want to route them.
    
    You must enable data events per bucket to be able to use this template.
    {: important}

    For more information, see [Cloud Object Storage auditing events](/docs/cloud-object-storage?topic=cloud-object-storage-at-events).

- IAM Identity: 

    This template uses IAM Identity auditing events to monitor any activity reported with the service credential that is used to upload objects into a bucket when the archiving feature is enabled.

    For more information, see [IAM Identity auditing events](/docs/activity-tracker?topic=activity-tracker-at_events_iam).

When you configure your {{site.data.keyword.cloud_notm}} account, you have different ways in which you can configure where auditing events are stored. You must deploy this template in each {{site.data.keyword.at_short}} instance where you store Cloud Object Storage events that are generated by buckets that you use to configure archiving, and in the instance where you store global events. 

## Deploying the archiving templates
{: #templates-archiving-deploy}

Complete the following steps to deploy the archiving template objects in 1 {{site.data.keyword.at_short}} instance:

### Step 1. Launch the template library
{: #templates-archiving-step1}

The {{site.data.keyword.at_short}} hosted event search offering template library offers multiple tiles that group predefined views, dashboards, and screens by area. One of them is the **Track Archiving** template.

Complete the following steps to launch the {{site.data.keyword.at_short}} template library:

1. [Log in to your {{site.data.keyword.cloud_notm}} account](https://cloud.ibm.com/login){: external}.

	After you log in with your user ID and password, the {{site.data.keyword.cloud_notm}} dashboard opens.

2. Click the **Menu** icon ![Menu icon](../icons/icon_hamburger.svg) &gt; **Observability**.

3. Select **Activity Tracker**.

    The list of {{site.data.keyword.at_short}} instances is displayed.

    There is 1 instance per region.
    {: important}

4. Select the {{site.data.keyword.at_short}} instance in the region where you want to deploy the template. Then, click **Open Dashboard**.



### Step 2. Get information to customize template objects
{: #templates-archiving-step2}

To get the information on the {{site.data.keyword.at_short}} instance, complete the following steps:

1. [Launch the {{site.data.keyword.at_short}} UI](/docs/activity-tracker?topic=activity-tracker-observe).

2. Select the instance name. Then, copy the **GUID** value. This value is the instance ID of the {{site.data.keyword.at_short}} instance.

To get the information on the Cloud Object Storage bucket, complete the following steps:

1. From the Navigation menu, select **Resource List**.
2. From the *Storage* section, select the {{site.data.keyword.cos_full_notm}} instance where the bucket that you want to monitor is available.
3. Select **Buckets**. Then, choose the bucket that you want to monitor.
4. Select **Configuration**. 

    Copy the bucket name. 

    Make sure that Activity Tracker is enabled for **Read and Write** action for the bucket.
    {: important}

To get information about the service ID, check the Cloud Object Storage **Service credentials** section and identify the service ID that is configured to authenticate by the {{site.data.keyword.at_short}} instance. 




### Step 3. Install the template
{: #templates-archiving-step3}

Complete the following steps to deploy the **Track Archiving** template:

1. From the {{site.data.keyword.at_short}} instance UI, click the **Settings** icon ![Settings icon](/images/config.png) &gt; **Template Library**.  The tiles show the available template libraries.  

2. In the Template library section, select the **Track Archiving** tile.

3. Choose from the available views, dashboards, or screens within the template that you want to deploy. Make sure you select the parsing templates.

4. Click **Apply template**.  

    If you do not select one or more options within the template library, all options will be deployed.
    {: note}

    What you deploy appear under the appropriate sections of the UI.  For example if you deploy a dashboard, it will deploy under **Dashboards**.

5. Refresh your browser to see the template objects.


After you deploy the template, it may take a while for the parsing templates to be enabled. The new indexed fields that are included with the parsing templates are needed for the template to filter and display data.
{: important}

## Template objects
{: #templates-archiving-objects}

### Predefined Cloud Object Storage views and alerts 
{: #templates-archiving-views}

Use these views to monitor Cloud Object Storage buckets. 
{: note}

The following table outlines predefined views that you can use to monitor activity in your account on Cloud Object Storage buckets:

| View name | Description | 
|-----------|-------------|
| `Client errors (4XX)` | Reports unauthorized attempts to access your archives, and other types of bad requests. Shows any requests that have a response reason code (RC) value of 4XX. |
| `Server errors (5XX)` | Reports server errors. Shows any requests that have a response reason code (RC) value of 5XX. |
| `Unauthorized access` | Reports unauthorized attempts to access your archives and manage the bucket. Checks reason codes 403 and 401.|
| `Partial content`     | Reports errors uploading an object in multiple parts into the bucket so you can find out when data is not complete. |
| `Enable archiving`    | Reports when archiving is enabled so you can keep track of which instances are configured, when archiving was enabled, and by whom. |
| `Disable archiving`   | Reports when archiving is disabled so you can keep track of which instances are not archiving data for long term storage. |
| `Delete bucket`       | Reports when a bucket is deleted. |
{: caption="Table 1. Available template views" caption-side="bottom"}

Be sure no one disables your archiving so you donâ€™t start to fail to save data you need for your compliance.
{: important}

The following templates include an alert definition:

- The template `Unauthorized access` includes an alert definition that sends an email when a request with RC 403 or 401 is reported. You must change the email address to the email to receive the alert. You can also define additional notification channels, such as Slack or PagerDuty.
- The template `Partial content` includes an alert definition that sends an email when an object is not uploaded completely. You must change the email address to the email to receive the alert. You can also define additional notification channels, such as slack or PagerDuty.

The information on these views include the following information for each record:
- Action that you can use to identify the type of request.
- Region where the bucket is located.
- Bucket name.
- Reason code (RC).
- Account ID that indicates the account where the bucket is available.
- Instance ID that indicates the Cloud Object Storage instance where the bucket is provisioned.



### Predefined views to monitor archiving of an instance
{: #templates-archiving-views}

Use these views to monitor the archiving of {{site.data.keyword.at_short}} hosted event search instances.
{: note}

To use these views, you must customize them with data from your account.


The following table outlines the predefined views that you can use to monitor 1 bucket:

| View name | Description |
|-----------|-------------|
| `Client errors (4XX)` | Reports unauthorized attempts to access your archives, and other types of bad requests for 1 bucket. Shows any requests that have a response reason code (RC) value of 4XX.  |
| `Server errors (5XX)` | Reports server errors for 1 bucket. Shows any requests that have a response reason code (RC) value of 5XX. |
| `Unauthorized access` | Reports unauthorized attempts to access your archives and manage 1 bucket. Checks reason codes 403 and 401.|
| `Partial content`     | Reports errors uploading an object in multiple parts into 1 bucket so you can find out when data is not complete. |
{: caption="Table 2. Bucket monitoring predefined views" caption-side="bottom"}

To use these views, you must customize them by entering the bucket name.
{: note}

The following table outlines the predefined views that you can use to monitor when archiving is enabled or disabled in an instance, and when data is archived or the bucket deleted:

| View name | Description |
|-----------|-------------|
| `Enable archiving`    | Reports when archiving is enabled for 1 instance. |
| `Disable archiving`   | Reports when archiving is disabled for 1 instance. |
| `Hourly archiving`    | Reports every time an object (file) is uploaded to the bucket that is configured for archiving for the instance that you are monitoring. |
| `Bucket delete`       | Reports when the bucket configured to collect data for 1 instance is deleted. |
| `Archive failures`    | Reports unsuccessful requests uploading objects to a bucket. Reports all reason codes except 200. |
{: caption="Table 3. Archiving enablement predefined views" caption-side="bottom"}

To use these views, you must customize them by entering the {{site.data.keyword.at_short}} hosted event search instance CRN, the bucket name, and the service ID that is used to authenticate and work with the bucket.
{: note}

The information on these views include the following information for each record:
- Action that you can use to identify the type of request.
- Region where the bucket is located.
- Bucket name.
- Reason code (RC).
- Account ID that indicates the account where the bucket is available.
- Instance ID that indicates the Cloud Object Storage instance where the bucket is provisioned.




### Predefined dashboards
{: #templates-archiving-dashboards}

The following table outlines the predefined dashboards that you can use to monitor {{site.data.keyword.at_short}} instances and {{site.data.keyword.la_short}} instances that have the archiving feature configured to an IBM Cloud Object Storage bucket:

| Dashboard name       | Description |
|----------------------|-------------|
| `Archiving bucket`   | Monitor archiving for 1 {{site.data.keyword.at_short}} hosted event search instance in an account. |
| `Archiving overview` | Monitor archiving across the account. |
{: caption="Table 4. Predefined dashboard" caption-side="bottom"}

To use these dashboards, you must customize them by entering the bucket name and the service ID that is used to authenticate and work with the bucket.
{: note}

The `Archiving bucket` dashboard includes graphs that show the log in requests to the bucket, the upload requests, and the partial upload requests. You can drill down into the data and look into the subplots that are defined to get more detailed information. 

The `Archiving overview` dashboard offers different graphs where you can see the buckets that are configured, the Cloud Object Storage instances where buckets are available, and the accounts where buckets are defined. You can drill down into the data and look into the subplots that are defined to get more detailed information. 

If you select a peak in a graph and select **Show logs**, a view opens and filters out the data to show you the auditing events that match that search criteria as defined in the dashboard.
{: tip}


### Predefined screens
{: #templates-archiving-screens}


The following table outlines the predefined screens that you can use to monitor {{site.data.keyword.at_short}} instances and {{site.data.keyword.la_short}} instances that have the archiving feature configured to an IBM Cloud Object Storage bucket:

| Screen name | Description |
|-------------|-------------|
| `Bucket <BUCKETNAME>` | View statistics about a single bucket. |
| `Archiving overview`  | View statistics about archiving across multiple instances in your account or Enterprise account. |
{: caption="Table 5. Predefined screens" caption-side="bottom"}

To use these screens, you must customize them by entering the bucket name and the service ID that is used to authenticate and work with the bucket.
{: note}


## Scenarios
{: #templates-scenarios}

Use the following scenarios to learn where to deploy the template and how to use it:

### Global events are managed through the Frankfurt {{site.data.keyword.at_short}} hosted event search instance
{: #templates-scenarios-1}

You can use these predefined views, dashboards, and screens to monitor archiving in any of the following scenarios:
- If your account is configured to monitor auditing events by using the {{site.data.keyword.at_short}} hosted event search offering, 

For the {{site.data.keyword.at_short}} instance or for {{site.data.keyword.at_short}} and {{site.data.keyword.la_short}} instances that are running in your account,. to quickly deploy predefined views, dashboards, and screens in an {{site.data.keyword.at_short}} hosted event search instance. that you can use to view and monitor Cloud Object Storage resources and actions such as the status of archiving of your {{site.data.keyword.at_short}} instance..

### Global events are managed through a custom {{site.data.keyword.at_short}} hosted event search instance
{: #templates-scenarios-2}


## Monitor archiving for {{site.data.keyword.at_short}} and {{site.data.keyword.la_short}} instances
{: #templates-scenarios-3}

Global events are managed through the Frankfurt {{site.data.keyword.at_short}} hosted event search instance. However you want to monitor archiving for 1 or more {{site.data.keyword.at_short}} and {{site.data.keyword.la_short}} instances in an account.




